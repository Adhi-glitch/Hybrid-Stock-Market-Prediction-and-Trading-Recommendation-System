@startuml Training_Pipeline_Diagram

!theme plain
title Model Training Pipeline
left to right direction

rectangle "Raw OHLCV Data" as Raw
rectangle "Data Cleaning" as Clean
rectangle "Feature Engineering\n(100+ technical indicators)" as Feat
rectangle "Scaling\n(MinMaxScaler)" as Scale
rectangle "Sequence Builder\n(lookback = 60)" as Seq
rectangle "Train/Val/Test Split\n(80/10/10)" as SplitStage
rectangle "LSTM Model\n(BiLSTM x3 + Dropout)" as LSTMModel
rectangle "Callbacks\n(EarlyStopping, ReduceLR, Checkpoint)" as Callbacks
rectangle "Training" as TrainingStage
rectangle "Evaluation\n(MAE, RMSE, MAPE, DA)" as Evaluation
rectangle "Best Weights Saved" as BestWeights

Raw --> Clean
Clean --> Feat
Feat --> Scale
Scale --> Seq
Seq --> SplitStage
SplitStage --> LSTMModel : X_train, y_train
LSTMModel --> Callbacks
LSTMModel --> TrainingStage
TrainingStage --> Evaluation
Callbacks --> BestWeights
Evaluation --> BestWeights

note bottom of LSTMModel
Optimizer: Adam (lr schedule)
Loss: MSE
Dropout: 0.3
end note

@enduml

